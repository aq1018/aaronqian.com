/* Tailwind v4 entry + plugin */
@import 'tailwindcss';
@plugin "@tailwindcss/typography";

/* Enable `.dark` class variant for Tailwind v4 */
@custom-variant dark (&:where(.dark, .dark *));

/* -----------------------------
   THEME TOKENS (GLOBAL)
   ----------------------------- */
@theme {
  /* Color Palettes (OKLCH) */
  --color-primary-50: oklch(0.97 0.01 250);
  --color-primary-100: oklch(0.93 0.03 250);
  --color-primary-200: oklch(0.86 0.06 250);
  --color-primary-300: oklch(0.77 0.11 250);
  --color-primary-400: oklch(0.67 0.16 250);
  --color-primary-500: oklch(0.57 0.2 250);
  --color-primary-600: oklch(0.47 0.18 250);
  --color-primary-700: oklch(0.37 0.14 250);
  --color-primary-800: oklch(0.29 0.1 250);
  --color-primary-900: oklch(0.22 0.06 250);
  --color-primary-950: oklch(0.15 0.03 250);

  /* Accent (Harvest Gold in light; will swap in dark below) */
  --color-accent-50: oklch(0.97 0.02 85);
  --color-accent-100: oklch(0.94 0.05 85);
  --color-accent-200: oklch(0.89 0.09 85);
  --color-accent-300: oklch(0.84 0.13 85);
  --color-accent-400: oklch(0.79 0.15 85);
  --color-accent-500: oklch(0.74 0.17 85); /* default accent (light) */
  --color-accent-600: oklch(0.64 0.15 85);
  --color-accent-700: oklch(0.54 0.13 85);
  --color-accent-800: oklch(0.44 0.1 85);
  --color-accent-900: oklch(0.34 0.07 85);
  --color-accent-950: oklch(0.24 0.04 85);

  /* Grays */
  --color-gray-50: oklch(0.99 0 0);
  --color-gray-100: oklch(0.96 0 0);
  --color-gray-200: oklch(0.9 0 0);
  --color-gray-300: oklch(0.83 0 0);
  --color-gray-400: oklch(0.64 0 0);
  --color-gray-500: oklch(0.49 0 0);
  --color-gray-600: oklch(0.38 0 0);
  --color-gray-700: oklch(0.28 0 0);
  --color-gray-800: oklch(0.2 0 0);
  --color-gray-900: oklch(0.14 0 0);
  --color-gray-950: oklch(0.08 0 0);

  /* Fonts */
  --font-sans: 'Inter', ui-sans-serif, system-ui, sans-serif;
  --font-mono: 'JetBrains Mono', Menlo, Monaco, 'Courier New', monospace;

  /* Z-index utilities for Tailwind v4 */
  --z-index-dropdown: 50;

  /* -----------------------------
     Semantic tokens (LIGHT defaults)
     These map to Tailwind classes:
     bg-surface, text-fg, border-border, text-muted, text-link, etc.
     ----------------------------- */
  --color-surface: var(--color-gray-50);
  --color-bg: var(--color-surface); /* Alias for backward compatibility */
  --color-fg: var(--color-gray-900);
  --color-border: var(--color-gray-200);
  --color-muted: var(--color-gray-500); /* Improved contrast from gray-600 */
  --color-link: var(--color-primary-600);
  --color-link-hover: var(--color-accent-hover);
  --color-highlight: var(--color-primary-100);

  /* Accent alias for convenience (bg-accent / text-accent) */
  --color-accent: var(--color-accent-500);
  --color-accent-hover: var(--color-accent-400);

  /* Tooltip colors */
  --color-tooltip-bg: var(--color-gray-900);
  --color-tooltip-fg: var(--color-accent-500);
  --color-tooltip-border: var(--color-gray-700);
}

/* -----------------------------
   THEME OVERRIDES (DARK)
   Keep overrides in the theme layer for correct order.
   ----------------------------- */
@layer theme {
  .dark {
    --color-surface: var(--color-gray-950);
    --color-fg: var(--color-gray-50);
    --color-border: var(--color-gray-800);
    --color-muted: var(--color-gray-200); /* Improved contrast from gray-300 */
    --color-link: var(--color-primary-400);
    --color-link-hover: var(--color-accent-hover);
    --color-highlight: var(--color-primary-900);

    /* Swap accent family in dark for better pop (cyan) */
    --color-accent: oklch(0.86 0.17 210); /* ~#00E0FF-ish in OKLCH */
    --color-accent-hover: oklch(0.88 0.15 210);

    /* Tooltip colors in dark mode */
    --color-tooltip-bg: var(--color-gray-800);
    --color-tooltip-fg: var(--color-accent);
    --color-tooltip-border: var(--color-gray-600);
  }
}

/* -----------------------------
   Global transitions (optional)
   ----------------------------- */
html {
  scroll-behavior: smooth;
  transition:
    background-color 300ms ease-in-out,
    color 300ms ease-in-out;
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
}

*,
*::before,
*::after {
  transition:
    background-color 300ms ease-in-out,
    color 300ms ease-in-out,
    border-color 300ms ease-in-out;
}

/* -----------------------------
   Power Grid Background
   SVG-based grid with pulsing electricity lines
   ----------------------------- */

/* Main container - responsive to theme */
.power-grid {
  position: relative;
  background-color: var(--color-surface);
  overflow: hidden;
}

/* -----------------------------
   Cutting Mat Background
   Technical grid with measurement markings
   ----------------------------- */

.cutting-mat {
  position: relative;
  background-color: var(--color-surface);
  overflow: hidden;
}

/* All gridlines now rendered via SVG in cuttingMat.ts */

/* Cutting mat uses accent color from parent */
.cutting-mat {
  color: var(--color-accent);
}

/* Container for cutting mat overlays (circles, diagonal lines, ruler markings) */
.cutting-mat-overlays {
  pointer-events: none;
}

/* -----------------------------
   Cursor blink animation
   ----------------------------- */
@keyframes blink {
  0%,
  50% {
    opacity: 1;
  }
  51%,
  100% {
    opacity: 0;
  }
}
.animate-blink {
  animation: blink 1.2s ease-in-out infinite;
}

/* Cursor blink for ASCII display at 0.8 Hz (1.25s period) */
@keyframes cursorBlink {
  0%,
  50% {
    opacity: 1;
  }
  51%,
  100% {
    opacity: 0;
  }
}
.animate-cursor-blink {
  animation: cursorBlink 1.25s ease-in-out infinite;
}

/* -----------------------------
   Circuit flow / data pulse animations
   ----------------------------- */
@keyframes circuitFlow {
  0% {
    transform: translateX(-100%);
    opacity: 0;
  }
  10% {
    opacity: 0.6;
  }
  90% {
    opacity: 0.6;
  }
  100% {
    transform: translateX(100vw);
    opacity: 0;
  }
}

@keyframes circuitFlowVertical {
  0% {
    transform: translateY(-100%);
    opacity: 0;
  }
  10% {
    opacity: 0.6;
  }
  90% {
    opacity: 0.6;
  }
  100% {
    transform: translateY(100vh);
    opacity: 0;
  }
}

.circuit-line {
  position: absolute;
  background: linear-gradient(90deg, transparent, var(--color-accent), transparent);
  height: 1px;
  width: 200px;
  opacity: 0;
  pointer-events: none;
  will-change: transform, opacity;
}

.circuit-line-vertical {
  position: absolute;
  background: linear-gradient(180deg, transparent, var(--color-accent), transparent);
  width: 1px;
  height: 200px;
  opacity: 0;
  pointer-events: none;
  will-change: transform, opacity;
}

/* -----------------------------
   Button glow effects
   ----------------------------- */
.btn-glow-accent {
  position: relative;
  isolation: isolate;
}

.btn-glow-accent::before {
  content: '';
  position: absolute;
  inset: -4px;
  border-radius: inherit;
  background: var(--color-accent);
  opacity: 0;
  filter: blur(12px);
  transition: opacity 0.3s ease-in-out;
  z-index: -1;
}

.btn-glow-accent:hover::before {
  opacity: 0.4;
}

.dark .btn-glow-accent:hover::before {
  opacity: 0.6;
}

/* -----------------------------
   Mono uppercase utility for CTAs
   ----------------------------- */
.text-mono-upper {
  font-family: var(--font-mono);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
