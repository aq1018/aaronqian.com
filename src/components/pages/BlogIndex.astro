---
import { Image } from 'astro:assets'
import type { CollectionEntry } from 'astro:content'
import Badge from '@/components/ui/Badge.astro'
import Section from '@/components/ui/Section.astro'
import Container from '@/components/ui/Container.astro'
import Stack from '@/components/ui/Stack.astro'
import Link from '@/components/ui/Link.astro'
import Heading from '@/components/ui/Heading.astro'
import Text from '@/components/ui/Text.astro'

interface Props {
  posts: CollectionEntry<'blog'>[]
}

const { posts } = Astro.props
---

<main class="flex-1">
  <Section variant="subsection">
    <Container>
      <Heading level="h1">Blog Posts</Heading>

      <Stack gap="medium" class="mt-8">
        {
          posts.map((post) => (
            <article class="border-b border-border pb-8">
              {post.data.hero && (
                <Link href={`/blog/${post.slug}`} variant="content" class="block">
                  <Image
                    src={post.data.hero}
                    alt={post.data.title}
                    width={800}
                    height={200}
                    class="mb-4 h-48 w-full rounded-lg object-cover"
                  />
                </Link>
              )}
              <Heading level="h2" weight="semibold">
                <Link
                  href={`/blog/${post.slug}`}
                  variant="content"
                  class="no-underline hover:underline"
                >
                  {post.data.title}
                </Link>
              </Heading>
              <Text variant="caption" class="mt-2">
                {post.data.date.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </Text>
              {post.data.description && <Text class="mt-3">{post.data.description}</Text>}
              {post.data.tags && (
                <Stack direction="horizontal" gap="tight" class="mt-3 flex-wrap">
                  {post.data.tags.map((tag) => (
                    <Badge color="muted" variant="soft" size="md">
                      {tag}
                    </Badge>
                  ))}
                </Stack>
              )}
            </article>
          ))
        }
      </Stack>
    </Container>
  </Section>
</main>
