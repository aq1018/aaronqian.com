---
import Icon from './Icon.astro'
import Link from './Link.astro'
import Tooltip from './Tooltip.astro'
import type { IconVariants } from './Icon.cva'
import type { LinkVariants } from './Link.cva'

import { cn } from '@/lib/utils'

export interface Props extends LinkVariants, IconVariants {
  href: string
  icon: string
  /** Accessible label for the link. Required for screen readers. Also used as tooltip if tooltip is not explicitly disabled. */
  label: string
  /** Set to false to hide the tooltip while keeping the aria-label */
  tooltip?: boolean
  external?: boolean
  class?: string
  tooltipPosition?: 'top' | 'bottom' | 'left' | 'right'
}

const {
  href,
  icon,
  label,
  tooltip = true,
  external = true,
  size = 'md',
  variant = 'nav',
  tooltipPosition = 'top',
  class: className,
} = Astro.props
---

{
  tooltip ? (
    <Tooltip text={label} position={tooltipPosition}>
      <Link
        {href}
        {external}
        {variant}
        aria-label={label}
        class={cn('inline-flex items-center justify-center', className)}
      >
        <Icon name={icon} {size} aria-hidden="true" />
      </Link>
    </Tooltip>
  ) : (
    <Link
      {href}
      {external}
      {variant}
      aria-label={label}
      class={cn('inline-flex items-center justify-center', className)}
    >
      <Icon name={icon} {size} aria-hidden="true" />
    </Link>
  )
}
