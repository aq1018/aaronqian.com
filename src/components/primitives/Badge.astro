---
import type { HTMLAttributes } from 'astro/types'

import { badgeVariants } from './Badge.cva'
import type { BadgeVariants } from './Badge.cva'

import { cn } from '@/lib/utils'

// HTMLAttributes first, then BadgeVariants overrides (including 'color')
export interface Props extends Omit<HTMLAttributes<'span'>, 'color'>, BadgeVariants {
  class?: string
}

const { size, color, variant, pulse, uppercase, class: className, ...rest } = Astro.props
---

<span class={cn(badgeVariants({ size, color, variant, pulse, uppercase }), className)} {...rest}>
  <slot />
</span>

<style>
  @keyframes pulseSubtle {
    0%,
    100% {
      opacity: 0.85;
      box-shadow: 0 0 0 0 color-mix(in srgb, var(--color-primary) 0%, transparent);
    }
    50% {
      opacity: 1;
      box-shadow: 0 0 8px 2px color-mix(in srgb, var(--color-primary) 30%, transparent);
    }
  }

  .animate-pulse-subtle {
    animation: pulseSubtle 2s ease-in-out infinite;
  }
</style>
