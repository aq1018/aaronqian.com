---
import { buttonVariants, type ButtonVariants } from './Button.cva'

interface Props extends ButtonVariants {
  href?: string
  external?: boolean
  type?: 'button' | 'submit' | 'reset'
  disabled?: boolean
  target?: string
  rel?: string
  class?: string
  [key: string]: any // Allow any additional HTML attributes
}

const {
  variant,
  color,
  size,
  fullWidth,
  href,
  external,
  type = 'button',
  disabled = false,
  target,
  rel,
  class: className = '',
  ...rest
} = Astro.props

const Element = href ? 'a' : 'button'

// Auto-detect external links
const isExternal =
  external || (href?.startsWith('http') && !href.includes(Astro.site?.hostname || ''))

// Set target and rel for external links
const linkTarget = target || (isExternal ? '_blank' : undefined)
const linkRel = rel || (isExternal ? 'noopener noreferrer' : undefined)
---

<Element
  {href}
  type={!href ? type : undefined}
  disabled={!href && disabled}
  target={linkTarget}
  rel={linkRel}
  class={buttonVariants({ variant, color, size, fullWidth, class: className })}
  {...rest}
>
  <slot />
</Element>
