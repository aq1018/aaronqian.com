---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const posts = await getCollection('blog');
const sortedPosts = posts.sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Blog - Aaron Qian</title>
  </head>
  <body>
    <main style="max-width: 800px; margin: 0 auto; padding: 2rem;">
      <h1>Blog Posts</h1>
      <p><a href="/">‚Üê Home</a></p>

      <div style="margin-top: 2rem;">
        {sortedPosts.map((post) => (
          <article style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #e5e5e5;">
            {post.data.hero && (
              <a href={`/blog/${post.slug}`}>
                <Image
                  src={post.data.hero}
                  alt={post.data.title}
                  width={800}
                  height={200}
                  style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;"
                />
              </a>
            )}
            <h2>
              <a href={`/blog/${post.slug}`} style="color: #0066cc; text-decoration: none;">
                {post.data.title}
              </a>
            </h2>
            <p style="color: #666; font-size: 0.9rem;">
              {post.data.date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              })}
            </p>
            {post.data.description && (
              <p>{post.data.description}</p>
            )}
            {post.data.tags && (
              <div style="margin-top: 0.5rem;">
                {post.data.tags.map((tag) => (
                  <span style="display: inline-block; background: #f0f0f0; padding: 0.25rem 0.5rem; margin-right: 0.5rem; border-radius: 3px; font-size: 0.85rem;">
                    {tag}
                  </span>
                ))}
              </div>
            )}
          </article>
        ))}
      </div>
    </main>
  </body>
</html>
